!function(a,b){b.fn.mediaView=function(a){var c=b.extend({viewHeight:426,canvasColor:"#111",captionColor:"#fff"},a);b(this).each(function(){function s(){k.click(function(){return"carousel"===q&&m.elastislide("destroy"),m.slideUp(),k.addClass("mv-view-selected"),l.removeClass("mv-view-selected"),q="fullview",!1}),l.click(function(){return v(),l.addClass("mv-view-selected"),k.removeClass("mv-view-selected"),q="carousel",!1})}function t(){e.css("backgroundColor",c.canvasColor),d.css("color",c.captionColor),o>1&&(f.touchwipe({wipeLeft:function(){w("right"),w("right")},wipeRight:function(){w("left")},preventDefaultEvents:!1}),b(document).on("keyup",function(a){39==a.keyCode?w("right"):37==a.keyCode&&w("left")}))}function u(a){h.addClass("mv-no-transition").removeClass("visible"),i.removeClass("visible"),j.attr("src",""),d.hide().empty(),g.show(),n.removeClass("selected"),a.addClass("selected");var e=a.find("a"),f=e.data("large"),k=e.data("description"),l=e.data("type");return"iframe"==l?(h.hide(),i.show(),j.attr("src",f),g.hide(),i.addClass("visible"),k&&d.show().html("<p>"+k+"</p>"),p=a.index(),"carousel"===q&&(m.elastislide("reload"),m.elastislide("setCurrent",p)),r=!1):b("<img/>").on("load",function(){i.hide(),h.show(),h.css("max-height",c.viewHeight+"px").attr("src",f),g.hide(),h.removeClass("mv-no-transition").addClass("visible"),k&&d.html("<p>"+k+"</p>").show(),"carousel"===q&&(m.elastislide("reload"),m.elastislide("setCurrent",p)),r=!1}).attr("src",f),!1}function v(){m.slideDown().elastislide({imageW:65,onClick:function(a){return!r&&(r=!0,u(a),void(p=a.index()))}}),m.elastislide("setCurrent",p)}function w(a){return!r&&(r=!0,"right"===a?p+1>=o?p=0:++p:"left"===a&&(p-1<0?p=o-1:--p),void u(n.eq(p)))}var a=b(this),d=a.find(".mv-caption"),e=a.find(".mv-canvas"),f=e.find(".mv-canvas-inner"),g=a.find(".mv-loader"),h=f.find(".mv-photo"),i=f.find(".mv-iframe-wrapper"),j=i.find(".mv-iframe"),k=a.find("a.mv-view-full"),l=a.find("a.mv-view-thumbs"),m=a.find("div.mv-carousel-wrapper"),n=m.find("li"),o=n.length,p=0,q="carousel",r=!1;s(),t(),v(),u(n.eq(0))})},b.fn.touchwipe=function(a){var c={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:!0};return a&&b.extend(c,a),this.each(function(){function e(){this.removeEventListener("touchmove",f),a=null,d=!1}function f(f){if(c.preventDefaultEvents&&f.preventDefault(),d){var g=f.touches[0].pageX,h=f.touches[0].pageY,i=a-g,j=b-h;Math.abs(i)>=c.min_move_x?(e(),i>0?c.wipeLeft():c.wipeRight()):Math.abs(j)>=c.min_move_y&&(e(),j>0?c.wipeDown():c.wipeUp())}}function g(c){1==c.touches.length&&(a=c.touches[0].pageX,b=c.touches[0].pageY,d=!0,this.addEventListener("touchmove",f,!1))}var a,b,d=!1;"ontouchstart"in document.documentElement&&this.addEventListener("touchstart",g,!1)}),this},b.elastislide=function(a,c){this.$el=b(c),this._init(a)},b.elastislide.defaults={speed:450,easing:"",imageW:65,margin:3,border:3,minItems:1,current:0,onClick:function(){return!1}},b.elastislide.prototype={_init:function(a){this.options=b.extend(!0,{},b.elastislide.defaults,a),this.$slider=this.$el.find("ul"),this.items=this.$slider.children("li"),this.itemsCount=this.items.length,this.esCarousel=this.$slider.parent(),this._validateOptions(),this._configure(),this._addControls(),this._initEvents(),this.$slider.show(),this._slideToCurrent(!1)},_validateOptions:function(){this.options.speed<0&&(this.options.speed=450),this.options.margin<0&&(this.options.margin=4),(this.options.minItems<1||this.options.minItems>this.itemsCount)&&(this.options.minItems=1),this.options.current>this.itemsCount-1&&(this.options.current=0)},_configure:function(){this.current=this.options.current,this.visibleWidth=this.esCarousel.width(),this.visibleWidth<this.options.minItems*(this.options.imageW+2*this.options.border)+(this.options.minItems-1)*this.options.margin?(this._setDim((this.visibleWidth-(this.options.minItems-1)*this.options.margin)/this.options.minItems),this._setCurrentValues(),this.fitCount=this.options.minItems):(this._setDim(),this._setCurrentValues()),this.$slider.css({width:this.sliderW})},_setDim:function(a){this.items.css({marginRight:this.options.margin,width:a?a:this.options.imageW+2*this.options.border})},_setCurrentValues:function(){this.itemW=this.items.outerWidth(!0),this.sliderW=this.itemW*this.itemsCount,this.visibleWidth=this.esCarousel.width(),this.fitCount=Math.floor(this.visibleWidth/this.itemW)},_addControls:function(){this.$navNext=b('<span class="es-nav-next">Next</span>'),this.$navPrev=b('<span class="es-nav-prev">Previous</span>')},_toggleControls:function(a,b){a&&b?1===b?"right"===a?this.$navNext.show():this.$navPrev.show():"right"===a?this.$navNext.hide():this.$navPrev.hide():(this.current===this.itemsCount-1||this.fitCount>=this.itemsCount)&&this.$navNext.hide()},_initEvents:function(){var c=this;b(a).on("resize.elastislide",function(a){c._reload(),clearTimeout(c.resetTimeout),c.resetTimeout=setTimeout(function(){c._slideToCurrent()},200)}),this.$navNext.on("click.elastislide",function(a){c._slide("right")}),this.$navPrev.on("click.elastislide",function(a){c._slide("left")}),this.$slider.on("click.elastislide","li",function(a){return c.options.onClick(b(this)),!1}),c.$slider.touchwipe({wipeLeft:function(){c._slide("right")},wipeRight:function(){c._slide("left")}})},reload:function(a){this._reload(),a&&a.call()},_reload:function(){var a=this;a._setCurrentValues(),a.visibleWidth<a.options.minItems*(a.options.imageW+2*a.options.border)+(a.options.minItems-1)*a.options.margin?(a._setDim((a.visibleWidth-(a.options.minItems-1)*a.options.margin)/a.options.minItems),a._setCurrentValues(),a.fitCount=a.options.minItems):(a._setDim(),a._setCurrentValues()),a.$slider.css({width:a.sliderW+10})},_slide:function(a,c,d,e){var f=parseFloat(this.$slider.css("margin-left"));if(void 0===c){var c,g=this.fitCount*this.itemW;if(g+=this.itemW,g<0)return!1;if("right"===a&&this.sliderW-(Math.abs(f)+g)<this.visibleWidth)g=this.sliderW-(Math.abs(f)+this.visibleWidth)-this.options.margin;else if("left"===a&&Math.abs(f)-g<0)g=Math.abs(f);else{var h;h="right"===a?Math.abs(f)+this.options.margin+Math.abs(g):Math.abs(f)-this.options.margin-Math.abs(g)}c="right"===a?"-="+g:"+="+g}else Math.max(this.sliderW,this.visibleWidth)-h<this.visibleWidth?(c=-(Math.max(this.sliderW,this.visibleWidth)-this.visibleWidth),0!==c&&(c+=this.options.margin),h=Math.abs(c)):0!==c&&(c=c+.35*this.visibleWidth+this.options.margin);b.fn.applyStyle=void 0===d?b.fn.animate:b.fn.css;var i={marginLeft:c};this.$slider.stop().applyStyle(i,b.extend(!0,[],{duration:this.options.speed,easing:this.options.easing,complete:function(){e&&e.call()}}))},_slideToCurrent:function(a){var b=this.current*this.itemW;this._slide("",-b,a)},add:function(a,b){this.items=this.items.add(a),this.itemsCount=this.items.length,this._setDim(),this._setCurrentValues(),this.$slider.css({width:this.sliderW}),this._slideToCurrent(),b&&b.call(a)},setCurrent:function(a,b){this.current=a;var c=Math.abs(parseFloat(this.$slider.css("margin-left"))),d=c+this.visibleWidth,e=Math.abs(this.current*this.itemW);(e+this.itemW>d||e<c+this.itemW||d-e<200||e+this.itemW>c)&&this._slideToCurrent(),b&&b.call()},destroy:function(a){this._destroy(a)},_destroy:function(c){this.$el.off(".elastislide").removeData("elastislide"),b(a).off(".elastislide"),c&&c.call()}},b.fn.elastislide=function(a){if("string"==typeof a){var c=Array.prototype.slice.call(arguments,1);this.each(function(){var d=b.data(this,"elastislide");return d?b.isFunction(d[a])&&"_"!==a.charAt(0)?void d[a].apply(d,c):void console.log('no such method "'+a+'" for elastislide instance'):void console.log('cannot call methods on elastislide prior to initialization; attempted to call method "'+a+'"')})}else this.each(function(){var c=b.data(this,"elastislide");c||b.data(this,"elastislide",new b.elastislide(a,this))});return this}}(window,jQuery);